<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Connexion ‚Äî PAF Stream</title>

<style>
body{
  font-family:Arial,Helvetica,sans-serif;
  background:linear-gradient(to top,rgba(0,0,0,.85),rgba(0,0,0,.6)),
  url("genesis.jpg") center/cover no-repeat;
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  color:#fff;
}
.login-box{
  background:#111;
  padding:40px;
  max-width:420px;
  width:100%;
  border-radius:10px;
}
input,button{
  width:100%;
  padding:14px;
  margin-bottom:14px;
  border:none;
  border-radius:6px;
}
input{background:#222;color:#fff}
button{background:#e50914;color:#fff;font-weight:bold}
.error{color:#ff6b6b;font-size:.9rem}
</style>
</head>

<body>

<div class="login-box">
  <h2>Connexion √† PAF Stream</h2>

  <input id="email" type="email" placeholder="Adresse e-mail" required>
  <input id="password" type="password" placeholder="Mot de passe" required>
  <input id="confirm" type="password" placeholder="Confirmer le mot de passe" required>

  <button onclick="login()">Se connecter</button>
  <p class="error" id="error"></p>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyBwABBsB1Sn1LU1CjCQpadHEz6tnebVLVY",
  authDomain: "paf-stream-web.firebaseapp.com",
  projectId: "paf-stream-web",
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

window.login = async () => {
  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;
  const confirm = document.getElementById("confirm").value;
  const error = document.getElementById("error");

  if(password !== confirm){
    error.textContent = "Les mots de passe ne correspondent pas";
    return;
  }

  try {
    // üîê tentative de connexion
    await signInWithEmailAndPassword(auth, email, password);
    window.location.href = "mur.html";
  } catch (err) {
    // üÜï si l'utilisateur n'existe pas ‚Üí cr√©ation
    if(err.code === "auth/invalid-credential" || err.code === "auth/user-not-found"){
      try{
        await createUserWithEmailAndPassword(auth, email, password);
        window.location.href = "mur.html";
      }catch(e){
        error.textContent = e.message;
      }
    } else {
      error.textContent = err.message;
    }
  }
};
</script>

</body>
</html>
